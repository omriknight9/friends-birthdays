let searchVal,lastChar,friends=[],counter=1,lang=1,now=new Date,currentYear=now.getFullYear(),sortBtnCounter=1,birthdayArr=[],birthdayToday=!1;function showResult(e,t){for(let a=0;a<$(e).length;a++){let r,n,s,o=$($(e)[a]).attr("name").toLowerCase(),i=$($(e)[a]).attr("nameHeb"),p=$($(e)[a]).attr("img"),l=$("#search").val(),c=l.charAt(0).toUpperCase()+l.slice(1);r=1==lang?o.toUpperCase():i.toUpperCase();try{n=1==lang?capitalize(o):i,s=capitalize(c)}catch(e){return}if(n.includes(s)||n.includes(s.toLowerCase())||i.includes(s)){let e=$("<div>",{class:"result",id:t,click:function(){let e=$(this).attr("id");$.each($(".container .personWrapper"),function(t,a){if($(this).attr("numId")==e){$("body").css("pointer-events","none");let e=this;$("#searchResults").hide(),$("#search").val(""),1==$(this).attr("isParent")?goToDiv($(this).parent().parent()):goToDiv($(this).parent()),setTimeout(function(){$(e).click(),$("body").css("pointer-events","all")},1500)}})}}).appendTo($("#searchResults")),a=$("<div>",{class:"resultImgWrapper"}).appendTo(e);$("<img>",{class:"resultImg",src:"./images/people"+p}).appendTo(a),$("<p>",{class:"resultName",text:n}).appendTo(e)}0==l.length||$(".result").length<1?$("#searchResults").hide():$("#searchResults").show()}}function showFriends(){$(".container").empty(),friends=[],counter=1,$(".btnWrapper").css("opacity",0),$(".spinnerWrapper").show(),setTimeout(function(){loadJson("./lists/friends.txt")},500),$(".sortContainer").fadeOut("fast"),sortBtnCounter=1}function sort(){1==sortBtnCounter?($(".sortContainer").fadeIn("fast"),sortBtnCounter=2):($(".sortContainer").fadeOut("fast"),sortBtnCounter=1)}function loadJson(e){$.get(e,function(e){friends.push(JSON.parse(e)),setTimeout(function(){buildPeople("friendsWrapper",$(".container"),friends),$("body").css("background-image","linear-gradient(180deg,rgba(200, 200, 200, .95), rgba(50,50,50,.95))")},500)})}function goToDiv(e){$("html, body").animate({scrollTop:$(e).position().top-170},1500)}function buildPeople(e,t,a){for(var r,n=a[0].friends,s=(h=new Date).getFullYear(),o=0;o<n.length;o++){var i,p,l=JSON.stringify(n[o].group),c=l.substring(0,l.indexOf("."));if($(i).hasClass("group"+c));else{i=$("<div>",{class:"group"+c+" groupWrapper"}).appendTo(t);var d=$("<div>",{class:"parentDiv"}).appendTo(i);c%2==0?$(i).addClass("evenGroup"):$(i).addClass("oddGroup")}p=1==lang?n[o].name:n[o].nameHeb;var h,u=new Date,g=(u.getMonth(),u.getFullYear()),m=(h=new Date(n[o].birthday)).getDate(),b=h.getMonth()+1,f=h.getFullYear(),y=(b=b<10?"0"+b:b)+"/"+(m=m<10?"0"+m:m),w=m+"/"+b+"/"+f,T=$("<div>",{class:"personWrapper",numId:n[o].id,birthday:n[o].birthday,name:n[o].name,nameHeb:n[o].nameHeb,group:n[o].group,img:n[o].image,isParent:n[o].parent,married:n[o].married,gender:n[o].gender,facebook:n[o].facebook,instagram:n[o].instagram,calendar:y,click:function(){"null"==$(this).attr("facebook")?$("#facebookLink").hide():($("#facebookLink").show(),$("#facebookLink").attr("href","https://www.facebook.com"+$(this).attr("facebook"))),"null"==$(this).attr("instagram")?$("#instagramLink").hide():($("#instagramLink").show(),$("#instagramLink").attr("href","https://www.instagram.com"+$(this).attr("instagram"))),$("#checkBirthdaysLink").attr("href","https://omriknight9.github.io/birthdays?name="+$(this).attr("name")+"&day="+$(this).attr("day")+"&month="+$(this).attr("month")),1==lang?$(".personNamePop").html($(this).attr("name")):$(".personNamePop").html($(this).attr("nameHeb")),$("#personCover").attr("src","./images/people"+$(this).attr("img")),$(".start").html($(this).attr("calendar")+"08:00 AM"),$(".end").html($(this).attr("calendar")+"10:00 AM"),1==lang?($(".title").html($(this).attr("name")+"'s Birthday"),$(".location").html($(this).attr("name")+"'s Home"),$(".nextBirthday").html("Next Birthday Will Be On "+$(this).attr("nextBirthday"))):($(".title").html("יומולדת ל"+$(this).attr("nameHeb")),$(".location").html("הבית של "+$(this).attr("nameHeb")),$(".nextBirthday").html("היומולדת הבא יהיה ביום "+$(this).attr("nextBirthday"))),$("#personDetails").fadeIn(150),1==$(this).attr("gender")?$("#personDetails .popupCont").css("background-color","lightblue"):$("#personDetails .popupCont").css("background-color","pink")}});let e,a,C;1==$(T).attr("gender")?(e="male.webp",$(T).addClass("boy"),a="0"==m.toString().charAt(0)?m.replace("0",""):m,C="0"==b.toString().charAt(0)?b.replace("0",""):b,a==now.getDate()&&now.getMonth()+1==C&&$(T).addClass("boyBornToday")):(e="female.webp",$(T).addClass("girl"),a="0"==m.toString().charAt(0)?m.replace("0",""):m,C="0"==b.toString().charAt(0)?b.replace("0",""):b,a==now.getDate()&&now.getMonth()+1==C&&$(T).addClass("girlBornToday")),r=1==lang?"Birthday: ":"יומולדת: ";$("<img>",{class:"genderImg",src:"./images/"+e,alt:"gender img"}).appendTo(T);let B;switch(b){case"01":case 1:B=m<20?"/capricorn.webp":"/aquarius.webp";break;case"02":case 2:B=m<19?"/aquarius.webp":"/pisces.webp";break;case"03":case 3:B=m<21?"/pisces.webp":"/aries.webp";break;case"04":case 4:B=m<20?"/aries.webp":"/taurus.webp";break;case"05":case 5:B=m<21?"/taurus.webp":"/gemini.webp";break;case"06":case 6:B=m<21?"/gemini.webp":"/cancer.webp";break;case"07":case 7:B=m<23?"/cancer.webp":"/leo.webp";break;case"08":case 8:B=m<23?"/leo.webp":"/virgo.webp";break;case"09":case 9:B=m<23?"/virgo.webp":"/libra.webp";break;case"10":case 10:B=m<23?"/libra.webp":"/scorpio.webp";break;case"11":case 11:B=m<22?"/scorpio.webp":"/sagittarius.webp";break;case"12":case 12:B=m<22?"/sagittarius.webp":"/capricorn.webp"}$("<img>",{class:"zodiacImg",src:"./images/zodiac"+B,alt:"zodiac img"}).appendTo(T);var k=g-f;1==$(T).attr("isParent")?($(T).appendTo(d),$(d).css("display","flex"),1==$(T).attr("gender")?($(T).addClass("suit"),buildCloths("suitImg","suit","suit img",T)):buildCloths("dressImg","dress","dress img",T)):($(d).remove(),1==$(T).attr("gender")?k<5?buildCloths("babyBoyImg","babyBoy","baby boy img",T):1==$(T).attr("married")?buildCloths("suitImg","suit","suit img",T):buildCloths("boyImg","boy","boy img",T):k<5?buildCloths("babyGirlImg","babyGirl","baby girl img",T):1==$(T).attr("married")?buildCloths("dressImg","dress","dress img",T):buildCloths("girlImg","girl","girl img",T),$(T).appendTo(i)),new Date($(T).attr("calendar")+"/"+s)<now?$(T).attr("calendar",$(T).attr("calendar")+"/"+Number(s+1)):$(T).attr("calendar",$(T).attr("calendar")+"/"+s);var v=$("<div>",{class:"personDetailsWrapper"}).appendTo(T),W=($("<p>",{class:"personName",text:p}).appendTo(v),$("<p>",{class:"personBirthday",text:r+w}).appendTo(v),$("<div>",{class:"personImgWrapper"}).appendTo(T));$("<img>",{class:"personImg",alt:"personImg",src:"./images/people"+n[o].image}).appendTo(W)}setTimeout(function(){checkAge(),checkClosest(),$(".btnWrapper").css("opacity",1),$(".spinnerWrapper").hide()},0)}function checkClosest(){let e;birthdayArr=[];for(let t=0;t<$(".groupWrapper .personWrapper").length;t++){let a=$($(".groupWrapper .personWrapper")[t]).attr("name"),r=$($(".groupWrapper .personWrapper")[t]).attr("nameHeb"),n=$($(".groupWrapper .personWrapper")[t]).attr("day"),s=$($(".groupWrapper .personWrapper")[t]).attr("month"),o=$($(".groupWrapper .personWrapper")[t]).attr("gender"),i=$($(".groupWrapper .personWrapper")[t]).attr("img"),p=new Date(now.getFullYear()+"/"+s+"/"+n);now.getDate()==n&&now.getMonth()+1==s?(e=now.getFullYear(),birthdayToday=!0):e=p<now?now.getFullYear()+1:now.getFullYear();let l=new Date(e+"/"+s+"/"+n);birthdayArr.push({name:a,gender:o,nameHeb:r,date:l,img:i})}setTimeout(function(){if(birthdayArr.sort(function(e,t){return Math.abs(now-e.date)-Math.abs(now-t.date)}),1==lang){let e;if(birthdayToday)$.each($(".personWrapper"),function(t,a){$(a).attr("name")==birthdayArr[0].name&&($(a).clone().appendTo($("#birthdayToday")),e=1==$(a).attr("gender")?1:2),$(a).attr("name")==birthdayArr[1].name&&($(a).clone().appendTo($("#birthdayToday")),e=1==$(a).attr("gender")?1:2)}),$.each($("#birthdayToday .personWrapper"),function(e,t){let a=$("<p>",{class:"closestBirth",text:"It's "}).insertAfter($(".spinnerWrapper")),r=$("<span>",{class:"birthdayColor",text:birthdayArr[e].name}).appendTo(a),n=($("<span>",{class:"closestSpan",text:"'s Birthday Today!"}).appendTo(a),$("<p>",{class:"birthdayWish"}).insertAfter(a));if("null"!==$(t).attr("facebook")){let a;a=1==birthdayArr[e].gender?"Wish Him Happy Birthday":"Wish Her Happy Birthday";$("<a>",{href:"https://www.facebook.com"+$(t).attr("facebook"),target:"_blank",text:a}).appendTo(n)}$(t).click(function(){goToBirthdayPerson($(t).attr("numid"))}),1==birthdayArr[e].gender?$(r).css("color","lightblue"):$(r).css("color","pink")});else{let e=$("<p>",{class:"closestBirth",text:"Closest Birthday: "}).insertAfter($(".spinnerWrapper"));$("<span>",{class:"birthdayColor",text:birthdayArr[0].name}).appendTo(e);1==birthdayArr[0].gender?$(".birthdayColor").css("color","lightblue"):$(".birthdayColor").css("color","pink"),$(window).width()>765&&($(".closestBirth").mouseenter(function(){if(!$("#searchResults").is(":visible")){let e=$("<div>",{class:"hoverImgContainer"}).hide().appendTo($(".closestBirth")).fadeIn(),t=$("<div>",{class:"hoverImgWrapper"}).appendTo(e);$("<img>",{class:"hoverImg",src:"./images/people"+birthdayArr[0].img}).appendTo(t)}}),$(".closestBirth").mouseleave(function(){$(".hoverImgContainer").fadeOut(400),$(".closestBirth").css("pointer-events","none"),setTimeout(function(){$(".hoverImgContainer").remove(),$(".closestBirth").css("pointer-events","all")},600)}).mouseleave())}}else if(birthdayToday){let e;$.each($(".personWrapper"),function(t,a){$(a).attr("name")==birthdayArr[0].name&&($(a).clone().appendTo($("#birthdayToday")),e=1==$(a).attr("gender")?1:2),$(a).attr("name")==birthdayArr[1].name&&($(a).clone().appendTo($("#birthdayToday")),e=1==$(a).attr("gender")?1:2)}),$.each($("#birthdayToday .personWrapper"),function(e,t){let a=$("<p>",{class:"closestBirth"}).insertAfter($(".spinnerWrapper")),r=$("<span>",{class:"birthdayColor",text:birthdayArr[e].nameHeb}).appendTo(a),n=($("<span>",{class:"closestSpan",text:" חוגג היום!"}).appendTo(a),$("<p>",{class:"birthdayWish"}).insertAfter(a));if("null"!==$(t).attr("facebook")){$("<a>",{href:"https://www.facebook.com"+$(t).attr("facebook"),target:"_blank",text:"אחל/י לו יום הולדת שמח"}).appendTo(n)}$(t).click(function(){goToBirthdayPerson($(t).attr("numid"))}),1==birthdayArr[e].gender?$(r).css("color","lightblue"):$(r).css("color","pink")})}else{let e=$("<p>",{class:"closestBirth",text:"החוגג הקרוב: "}).insertAfter($(".spinnerWrapper"));$("<span>",{class:"birthdayColor",text:birthdayArr[0].nameHeb}).appendTo(e);1==birthdayArr[0].gender?$(".birthdayColor").css("color","lightblue"):$(".birthdayColor").css("color","pink"),$(window).width()>765&&($(".closestBirth").mouseenter(function(){if(!$("#searchResults").is(":visible")){let e=$("<div>",{class:"hoverImgContainer"}).hide().appendTo($(".closestBirth")).fadeIn(),t=$("<div>",{class:"hoverImgWrapper"}).appendTo(e);$("<img>",{class:"hoverImg",src:"./images/people"+birthdayArr[0].img}).appendTo(t)}}),$(".closestBirth").mouseleave(function(){$(".hoverImgContainer").fadeOut(400),$(".closestBirth").css("pointer-events","none"),setTimeout(function(){$(".hoverImgContainer").remove(),$(".closestBirth").css("pointer-events","all")},600)}).mouseleave())}},1e3)}function goToBirthdayPerson(e){$.each($(".container .personWrapper"),function(t,a){$(a).attr("numId")==e&&$(a).click()})}function checkAge(){$.each($(".personWrapper"),function(e,t){getAge($(this),$(this).attr("birthday"),$(this).attr("calendar"))})}function buildCloths(e,t,a,r){$("<img>",{class:"clothesImg",id:t,src:"./images/"+t+".webp",alt:a}).appendTo(r)}function getAge(e,t,a){var r,n=new Date,s=new Date(t),o=new Date(a),i=n.getFullYear()-s.getFullYear(),p=n.getMonth()-s.getMonth(),l=o.getMonth()+1,c=o.getDate(),d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"];if(p<0||0===p&&n.getDate()<s.getDate()?(1==lang?$(e).attr("nextBirthday",d[o.getDay()]):$(e).attr("nextBirthday",h[o.getDay()]),i--):(o.setFullYear(o.getFullYear()),1==lang?$(e).attr("nextBirthday",d[o.getDay()]):$(e).attr("nextBirthday",h[o.getDay()])),0==i){let e,a,r,s=(a=n.getMonth()+1<10?"0"+Math.round(n.getMonth()+1):n.getMonth()+1)+"/"+(r=n.getDate()<10?"0"+Math.round(n.getDate()):n.getDate())+"/"+n.getFullYear();const o=new Date(t),p=new Date(s);e=12*(p.getFullYear()-o.getFullYear())+(p.getMonth()-o.getMonth()),i=1==lang?e+" Months":e+" חודשים"}$(e).attr("age",i),$(e).attr("month",l),$(e).attr("day",c),r=1==lang?"Age: ":"גיל: ";$("<p>",{class:"personAge",text:r+i}).appendTo($(e).find($(".personDetailsWrapper")));return i}function goToTop(){$("html,body").animate({scrollTop:0},"slow")}function scrollBtn(){$(this).scrollTop()>550?$(".goToTopBtn").fadeIn():$(".goToTopBtn").fadeOut()}function sortFriends(e,t){$(".groupWrapper").removeClass("oddGroup"),$(".groupWrapper").removeClass("evenGroup"),"calendar"==e||$(".btnWrapper").attr("kind")==t||($(".btnWrapper").attr("kind",t),counter=1),3==t&&$(".container").empty(),2==lang&&"name"==e&&(e="nameHeb"),$.each($(".container"),function(a,r){var n,s,o,i=[],p=$(this).find(".personWrapper");for(s=0,o=p.length;s<o;s++){(n={}).element=p[s];var l=$(p[s]).attr(e);switch(t){case 1:n.idNum=new Date(l);break;case 2:n.idNum=l;break;case 3:n.idNum=parseInt(l.replace(/[^\d]/g,""),10)}i.push(n)}switch(t){case 1:switch(counter){case 1:i.sort(function(e,t){return t.idNum-e.idNum}),counter=2;break;case 2:i.sort(function(e,t){return e.idNum-t.idNum}),counter=1}$(".btnWrapper").attr("kind",t),$(".groupSortBtn").css("pointer-events","all");break;case 2:switch(counter){case 1:i.sort(function(e,t){return e.idNum.localeCompare(t.idNum)}),counter=2;break;case 2:i.sort(function(e,t){return t.idNum.localeCompare(e.idNum)}),counter=1}$(".btnWrapper").attr("kind",t),$(".groupSortBtn").css("pointer-events","all");break;case 3:$(".closestBirth").html(""),$(".birthdayWish").html(""),birthdayToday&&$(".personWrapper").first().remove(),$("body").css("background-image","unset"),$(".spinnerWrapper").show(),$(".btnWrapper").css("opacity",0),$(".groupSortBtn").css("pointer-events","none"),showFriends(),setTimeout(function(){$(".btnWrapper").css("opacity",1),$(".spinnerWrapper").hide()},500)}for(s=0;s<i.length;s++)$(this).append(i[s].element)}),$(".sortContainer").fadeOut("fast"),sortBtnCounter=1}function removePopup(e){$(document).mouseup(function(t){e.is(t.target)&&0===e.has(t.target).length&&(e.hide(),t.stopPropagation(),$(document).off("mouseup"))})}function closeCurrentPopup(e){$($(e)[0].parentElement.parentElement.parentElement).fadeOut(150)}function capitalize(e){e=e.split(" ");for(let t=0;t<e.length;t++)e[t]=e[t][0].toUpperCase()+e[t].substr(1);return e.join(" ")}$(document).ready(function(e){loadJson("./lists/friends.txt"),window.location.href.indexOf("lang=he")>-1&&setTimeout(function(){changeToHeb(),window.history.pushState("page2","Title","index.html")},600),$("#langBtnHe").click(function(){changeToHeb(),$("#search").val(""),$("#searchResults").hide(),birthdayToday&&$(".personWrapper").first().remove()}),$("#langBtnEn").click(function(){changeToEng(),$("#search").val(""),$("#searchResults").hide(),birthdayToday&&$(".personWrapper").first().remove()}),window.onbeforeunload=function(){window.scrollTo(0,0)},window.onscroll=function(){scrollBtn()},$(".Xbtn").click(function(){$(this).parent().parent().fadeOut(150)}),setTimeout(function(){$(".spinnerWrapper").hide(),$(".searchContainer").show(),$(".btnWrapper").css("opacity",1)},1500),$("#search").on("input",function(){searchVal=$("#search").val()," "!=(lastChar=searchVal.substr(searchVal.length-1))&&($("#searchResults").empty(),$("#searchResults").hide(),$.each($(".container .personWrapper"),function(e,t){let a=$(t).attr("numId");showResult($(this),a)}))})});